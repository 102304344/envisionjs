
humblevis={},function(){function a(a){this.data=a}a.prototype={bound:function(a,b){if(!_.isNumber(a)||!_.isNumber(b))return this;var c=this.data,d=c.length,e=[],f;for(f=0;f<d;f++)if(c[f][0]>=a)break;f>0&&f--;for(f;f<d;f++){e.push(c[f]);if(c[f][0]>b)break}return this.data=e,this},subsampleMinMax:function(a){var b=this.data,c=b.length,d=c-1,e=[],f=a/c,g=Math.round(f*1),h=1,i=1,j,k,l,m,n;if(c>a){e.push(b[0]);for(m=1;m<d;m++)n=Math.round(f*m),n!==g?(i===h?e.push(b[h]):e.push(b[Math.min(h,i)],b[Math.max(h,i)]),h=i=m,j=k=b[m][1],g=n):(l=b[m][1],l<j&&(h=m,j=l),l>k&&(i=m,k=l));e.push(b[c-1]),this.data=e}return this},subsample:function(a){var b=this.data,c=b.length,d=[],e=c/a,f;if(c>a){d.push(b[0]);for(f=1;f<a;f++){if(f*e>=c)break;d.push(b[Math.round(f*e)])}d.push(b[c-1]),this.data=d}return this}},humblevis.Data=a}(),function(){function d(a){this.options=a||{},this.children=[],this.container=null,this.rendered=!1}var a="humble-vis-first",b="humble-vis-last",c='<div class="humble-vis-visualization"></div>';d.prototype={render:function(a){var b=this.options;a=a||b.element;if(!a)throw"No element to render within.";this.container=bonzo.create(c),bonzo(a).append(this.container),_.each(this.children,function(a){a.render(this.container)},this),this._updateClasses(),this.rendered=!0},add:function(a){return this.children.push(a),this.rendered&&(a.render(this.container),this._updateClasses()),a},remove:function(a){var b=this.children,c=this.indexOf(a);if(c!==-1)return b.splice(c,1),bonzo(a.node).remove(),this._updateClasses(),!0},setPosition:function(a,b){var c=this.children;if(b>=0&&b<c.length&&this.remove(a))return b===c.length?bonzo(this.container).append(a.node):this.container[0].insertBefore(a.node[0],c[b].node[0]),c.splice(b,0,a),this._updateClasses(),!0},indexOf:function(a){return _.indexOf(this.children,a)},getChild:function(a){var b=this.children;if(a<b.length)return b[a]},isFirst:function(a){return this.indexOf(a)===0?!0:!1},isLast:function(a){return this.indexOf(a)===this.children.length-1?!0:!1},_updateClasses:function(){var c=this.children,d=0,e=c.length-1,f;_.each(c,function(c,g){f=bonzo(c.node),g===d?f.addClass(a):f.removeClass(a),g===e?f.addClass(b):f.removeClass(b)})}},humblevis.Visualization=d}(),function(){function b(a){this.options=a=a||{},this.actions=[],this.followers=[],this.leaders=[],this.prevent={},a.leader&&this.lead(a.leader)}var a=Flotr.EventAdapter;b.prototype={getLeaders:function(){return this.leaders},getFollowers:function(){return this.followers},getActions:function(){return this.actions},lead:function(a){this.leaders.push(a),_.each(this.actions,function(b){this._bindLeader(a,b)},this)},follow:function(a){this.followers.push(a)},group:function(a){_.isArray(a)||(a=[a]),_.each(a,function(a){this.lead(a),this.follow(a)},this)},add:function(a,b){this.actions.push(a),_.each(this.leaders,function(c){this._bindLeader(c,a,b)},this)},_bindLeader:function(b,c,d){_.each(c.events,function(c,e){a.observe(b.container,e,_.bind(function(){if(this.prevent[e])return;var a=[b].concat(Array.prototype.slice.call(arguments)),f=null;c.handler&&(f=c.handler.apply(this,a)),d&&d.callback&&d.callback.call(this,f),this.prevent[e]=!0;try{_.each(this.followers,function(a){if(b===a)return;c.callback.apply(this,[a,f])},this)}catch(g){throw this.prevent[e]=!1,g}this.prevent[e]=!1},this))},this)}},humblevis.Interaction=b}(),function(){var a={events:{"flotr:select":{handler:function(a,b){var c=a.getData(),d=b.x1,e=b.x2;return{xaxis:{min:d,max:e}}},callback:function(a,b){a.draw(null,b)}},"flotr:click":{handler:function(){var a=this.leaders[0],b=a.flotr.axes.x.min,c=a.flotr.axes.x.max;return{xaxis:{min:b,max:c}}},callback:function(a,b){a.draw(null,b)}}}};humblevis.action=humblevis.action||{},humblevis.action.selection=a}(),function(){var a={events:{"flotr:hit":{handler:function(a,b){return b},callback:function(a,b){var c=b.x,d=a.flotr,e;e={relX:d.axes.x.d2p(c),relY:1},d.hit.hit(e)}},mouseout:{callback:function(){_.each(this.followers,function(a){a.flotr.hit.clearHit()},this)}}}};humblevis.action=humblevis.action||{},humblevis.action.hit=a}(),humblevis.templates=humblevis.templates||{},humblevis.flotr={},humblevis.flotr.defaultOptions={grid:{outlineWidth:0,labelMargin:0,horizontalLines:!1,verticalLines:!1},bars:{show:!1,barWidth:.5,fill:!0,lineWidth:2,fillOpacity:1},lines:{lineWidth:1},xaxis:{margin:!1,tickDecimals:0,showLabels:!1},yaxis:{margin:!1,showLabels:!1},shadowSize:!1},function(){function f(a){this.options=a||{},this.container=bonzo.create(d)[0],this.node=bonzo.create(c),a.name&&bonzo(this.node).addClass(a.name),bonzo(this.node).append(this.container),this.flotr=null,this._flotrDefaultOptions()}var a=humblevis,b="humble-vis-child",c='<div class="'+b+'"></div>',d='<div class="'+b+'-container"></div>',e=a.flotr.defaultOptions;f.prototype={getFlotr:function(){return this.flotr},getData:function(){return this.options.data},render:function(a){var b=this.options;if(!a)throw"No element to render within.";bonzo(a).append(this.node),b.width?bonzo(this.container).css({width:b.width}):b.width=parseInt(bonzo(this.container).css("width"),10),b.height?bonzo(this.container).css({height:b.height}):b.height=parseInt(bonzo(this.container).css("height"),10),this.draw(b.data,b.flotr)},draw:function(a,b){var c=this.options,d=[],e=this.container;a=a||c.data,b&&(b=Flotr.clone(b),_.extend(c.flotr,b),this._flotrDefaultOptions(b)),b=c.flotr,c.data=a,min=b.xaxis.min,max=b.xaxis.max,a=this._getDataArray(a),c.skipPreprocess?d=a:_.each(a,function(a,b){!_.isArray(a)&&!_.isFunction(a)?(d[b]=_.clone(a),d[b]=this._processData(a.data)):d[b]=this._processData(a)},this);if(!b)throw"No graph submitted.";this.flotr=Flotr.draw(e,d,b)},getNode:function(){return this.node},_processData:function(b){var c=this.options,d=c.processData,e=c.width,f=c.flotr.xaxis,g=f.min,h=f.max,i=new a.Data(b);return _.isFunction(b)?b(g,h,e):(d?d.apply(this,[{datum:i,min:g,max:h,resolution:e}]):i.bound(g,h).subsampleMinMax(e),i.data)},_getDataArray:function(a){return a[0]&&(!_.isArray(a[0])||a[0][0]&&_.isArray(a[0][0]))?a:[a]},_flotrDefaultOptions:function(a){var b=a||this.options.flotr,c;for(c in e)e.hasOwnProperty(c)&&(_.isUndefined(b[c])?b[c]=e[c]:_.defaults(b[c],e[c]))}},a.Child=f}(),function(){function c(){return{flotr:{}}}function d(){return{flotr:{handles:{show:!0},selection:{mode:"x"}}}}function e(a,b){var c=_.defaults(a,b);return c.flotr=_.defaults(c.flotr,b.flotr),c}var a=humblevis,b;b=function(b){var f=new a.Visualization,g=new a.Child(e(b.zoom||{},c())),h=new a.Child(e(b.summary||{},d())),i=new a.Interaction({leader:h});f.add(g),f.add(h),i.add(a.action.selection),i.follow(g),this.vis=f,this.interaction=i,b.container&&this.render(b.container)},b.prototype={render:function(a){this.vis.render(a)}},a.templates.Zoom=b}()